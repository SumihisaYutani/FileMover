# FileMover - 実装タスク一覧

## 11. 実装タスク（開発順序）

### フェーズ 1: 基盤構築

#### 1.1 リポジトリ初期化
- [ ] Cargo workspace 構成（apps/gui, apps/cli, core/*）
- [ ] 基本的な依存関係の設定
- [ ] CI/CDパイプライン（Windows ランナー）

#### 1.2 コア型定義（core/types）
- [ ] Pattern/Rule/Plan/Journal のモデル定義
- [ ] エラー型の定義
- [ ] 設定型の定義
- [ ] シリアライゼーション対応（serde）

### フェーズ 2: コアライブラリ実装

#### 2.1 パターンマッチャー（core/matcher）
- [ ] 文字列正規化（NFC/NFKC、ケースフォールド、ダイアクリティクス除去）
- [ ] Globパターンマッチング（globset）
- [ ] 正規表現マッチング（前置フィルタ最適化）
- [ ] Contains マッチング（Aho-Corasick）
- [ ] 簡易DSLパーサ（AND/OR/NOT）

#### 2.2 ディレクトリスキャナー（core/scanner）
- [ ] WinAPI FindFirstFileExW/FindNextFileW バインディング
- [ ] 長パス対応（\\?\ プレフィックス）
- [ ] 並列ディレクトリ走査（rayon）
- [ ] システム保護フォルダの除外機能
- [ ] ジャンクション/シンボリックリンクの処理

#### 2.3 プラン生成器（core/planner）
- [ ] Before/After木の生成
- [ ] 衝突検出（名前重複、循環参照、権限）
- [ ] 自動リネーム機能
- [ ] テンプレート展開（{name}, {yyyy}等）
- [ ] インクリメンタル検証

### フェーズ 3: 実行エンジン

#### 3.1 ジャーナルシステム（core/journal）
- [ ] JSONL形式でのログ出力
- [ ] 操作履歴の記録
- [ ] Undo用の逆操作ログ生成

#### 3.2 ファイル操作実行器（core/executor）
- [ ] IFileOperation WinAPI バインディング
- [ ] Move/Copy+Delete操作
- [ ] ACL/属性の保持
- [ ] 進捗レポート機能
- [ ] キャンセル/一時停止対応
- [ ] 指数バックオフ再試行
- [ ] Shell Undo統合

### フェーズ 4: CLI実装

#### 4.1 基本CLIコマンド（apps/cli）
- [ ] `scan` サブコマンド（フォルダスキャン）
- [ ] `plan` サブコマンド（プラン生成）
- [ ] `dry-run` サブコマンド（シミュレーション）
- [ ] `apply` サブコマンド（実行）
- [ ] `undo` サブコマンド（元に戻す）

#### 4.2 設定・プロファイル管理
- [ ] JSON設定ファイルの読み書き
- [ ] プロファイルの保存・読込
- [ ] 設定バリデーション

#### 4.3 E2Eテスト環境
- [ ] サンドボックス用ダミーデータ生成
- [ ] 統合テストスイート
- [ ] パフォーマンステスト（10万ノード）

### フェーズ 5: GUI実装

#### 5.1 Tauriセットアップ（apps/gui）
- [ ] Tauri プロジェクト初期化
- [ ] フロントエンド選択・セットアップ（React/Vue）
- [ ] Tauri コマンドの定義
- [ ] 基本的なウィンドウ設定

#### 5.2 画面① - ルート＆ルール管理
- [ ] ルートディレクトリ選択UI
- [ ] ルール表の実装（追加/編集/削除）
- [ ] ルールプレビュー機能
- [ ] 設定の保存・読込

#### 5.3 画面② - 検索結果
- [ ] 仮想化リスト実装
- [ ] フィルタ・ソート機能
- [ ] バッジ表示（警告・衝突等）
- [ ] CSV エクスポート

#### 5.4 画面③ - プラン確認（最重要）
- [ ] 2ペイン比較ツリー
- [ ] 遅延ロード・仮想化
- [ ] 同期スクロール・ハイライト
- [ ] ノード単位の編集機能
- [ ] リアルタイム検証

#### 5.5 画面③' - 最終確認
- [ ] 実行サマリ表示
- [ ] 危険操作の警告
- [ ] 必要権限の確認

#### 5.6 画面④ - 実行中
- [ ] 進捗バーとリアルタイム更新
- [ ] 一時停止・キャンセル機能
- [ ] ログ表示

#### 5.7 画面⑤ - 結果・Undo
- [ ] 実行結果サマリ
- [ ] 失敗操作の再実行
- [ ] Undo機能
- [ ] ログ・ジャーナルへのリンク

### フェーズ 6: 最終統合・QA

#### 6.1 ログ・監視
- [ ] tracing ログシステム統合
- [ ] 日次ローテーション
- [ ] ログレベル設定

#### 6.2 パフォーマンス最適化
- [ ] メモリ使用量の最適化
- [ ] UI応答性の改善
- [ ] 大量データでの負荷テスト

#### 6.3 テスト・品質保証
- [ ] ユニットテスト（全モジュール）
- [ ] 統合テスト
- [ ] UI自動テスト
- [ ] Windows 10/11での動作確認

#### 6.4 ドキュメント・配布
- [ ] ユーザーマニュアル
- [ ] インストーラー作成
- [ ] リリースノート

## 12. 開発優先順位

### 最優先（MVP）
1. types → matcher → scanner → planner
2. CLI での scan → plan → dry-run 機能
3. サンドボックス環境でのE2Eテスト

### 高優先（β版）
4. executor → journal → undo 機能
5. GUI 画面①②③の基本実装

### 中優先（正式版）
6. GUI 画面③'④⑤の実装
7. パフォーマンス最適化
8. 包括的テストスイート

### 低優先（拡張版）
9. 高度なUI機能（アニメーション、テーマ等）
10. プラグインシステム
11. ネットワークドライブ最適化

## 見積もり工数

- **フェーズ1-2（基盤）**: 2-3週間
- **フェーズ3（実行エンジン）**: 2-3週間
- **フェーズ4（CLI）**: 1-2週間
- **フェーズ5（GUI）**: 4-6週間
- **フェーズ6（統合・QA）**: 2-3週間

**合計**: 約3-4ヶ月（フルタイム開発の場合）